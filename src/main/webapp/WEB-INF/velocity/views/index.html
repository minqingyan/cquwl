<link rel="stylesheet" href="assets/css/block.css" />
<link rel="stylesheet" href="assets/css/mqy/index.css" />
<link href="assets/css/star-rating.css" media="all" rel="stylesheet" type="text/css" />
<script src="assets/js/star-rating.js" type="text/javascript"></script>

<script type="text/javascript">
function postDZSH(){
	var name=$('#dzshname option:selected').val();
	var weight=$('#weight').val();
	var volumn=$('#volumn').val();
	var city_picker_dz_start=$('#city_picker_dz_start').val();
	var date_picker_dz_start=$('#date_picker_dz_start').val();
	var date_picker_dz_end=$('#date_picker_dz_end').val();
	var dz_name=$('#dz_name').val();
	var dz_phone=$('#dz_phone').val();
	var data={"name":name,"weight":weight,"volumn":volumn,"city_picker_dz_start":city_picker_dz_start,"date_picker_dz_start":date_picker_dz_start,
			"date_picker_dz_end":date_picker_dz_end,"dz_name":dz_name,"dz_phone":dz_phone};
	console.log(data);
	$.post('dzsh',data,function(data,status){
			
		});	
}

</script>

<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog" style="width: 1000px; height: 450px">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel">订单信息</h4>
			</div>
			<div class="modal-body" style="height: 400px; text-align: right">
				<div class="row">
					<ul class="steps">
						<li data-step="1" class="active"><span class="step">1</span> <span class="title">接单</span></li>

						<li data-step="2"><span class="step">2</span> <span class="title">确认合同/开始运输</span></li>

						<li data-step="3"><span class="step">3</span> <span class="title">评价</span></li>

						<li data-step="4"><span class="step">4</span> <span class="title">交易完成</span></li>
					</ul>
				</div>
				<br>
				<div class="hr hr13 dotted"></div>
				<div class="row">
					<div class="col-xs-12">
						<div class="col-xs-4" align="left">
							<label id="id" style="display: none"></label>
							<div class="row">
								<div style="float: left">
									<span class="profile-picture"> <img id="avatar" class="editable img-responsive editable-click editable-empty"
										alt="Alex's Avatar" src="assets/avatars/profile-pic.jpg" style="width: 70px;height:70px;"></img>
									</span>
								</div>
								<div style="float: left">
									<div>&nbsp;&nbsp;<span id="name"></span></div>
									<div>
										&nbsp;&nbsp;<span id="carNumber"></span>
									</div>
									<div>
										&nbsp;&nbsp;<span id="carPhone"></span>
									</div>
								</div>
							</div>
							<div class="row">
								<span class="badge badge-info">起：</span>&nbsp;<span id="carNowPlace">sdf</span>
							</div>
							<div class="row">
								<span class="badge badge-danger">终：</span>&nbsp;<span id="carToPlace">sdf</span>
							</div>
							<div class="hr hr13 dotted"></div>
							<div class="row">
								货物描述:<ul id="carMsg"></ul>
							</div>
						</div>

						<div class="col-xs-4" align="center">
							<div>
								<label class="control-label" for="form-field-1"><font color="red">提醒：如对方索取信息费，请谨慎交易！ </font></label>
							</div>
							<div>
								<label class="control-label" for="form-field-1"><font color="red">须知：发货人认证信息不完整，请知悉！</font></label>
							</div>
							<br>
							<div>
								<label class=" control-label" for="form-field-1">身份证、营业执照、名片照、门头照！</label>
							</div>
							<br>
							<br>
							<div>
								<label class=" control-label no-padding-right" for="form-field-1"> 报价</label> <input type="text" id="money" name="money"
									placeholder="金额">
							</div>
							<br>
							<br>
							<div>
								<button onclick="taking()" class="btn btn-primary" style="width: 100px">接 单</button>
							</div>
						</div>
						<div class="col-xs-4">
							<div class="alert alert-info" style="height: 250px;" align="left">
								<div>1、为确保您的权益得到保障，建议选择资质已认证的发货人</div>
								<br>
								<br>
								<div>2、为保障您的运费资金安全，欢迎使用平台在线支付运费。</div>
								<br>
								<br>
								<div align="center">支付使用问题与投诉请致电</div>
								<div align="center">400-996-2888</div>
							</div>
						</div>
					</div>
				</div>
				<br>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal -->
	</div>
</div>

<div class="main-content" style="z-index: 1; position:relative;margin:0 auto;width:100%;height: auto;" >
			
		<div class="center div-form">
					<div id="topMenu" >
						<div class="tabbable tabs-left" style="background-color: white;">
							<ul class="nav nav-tabs" id="myTab3">
								<li class="active" style="height: 50%;"><a data-toggle="tab" href="#home3" aria-expanded="false"> 大<br>宗<br>散<br>货
								</a></li>

								<li class=""  style="height: 50%;"><a data-toggle="tab" href="#profile3" aria-expanded="true"> 普<br>通<br>件<br>杂<br>货
								</a></li>
							</ul>

							<div class="tab-content">
								<div id="home3" class="tab-pane active">
									<form class="form-horizontal" action="dzsh" method="post">
										<div class="form-group">
											<label class="col-xs-2 control-label no-padding-right" for="form-field-1">货物描述 ：</label>
											<div class="col-xs-10">
											<div class="input-group width-30" style="float: left">
												<select class="form-control" name="dzshname" id="dzshname"><option>---货物类型---</option>
													<option>粮食谷物</option><option>棉花</option><option>煤炭</option><option>非金属矿石</option><option>矿物性建筑材料</option><option>水泥</option><option>盐制品</option><option>其他</option>
												</select></div>
												<div class="input-group width-20" style="float: left"><input type="text" id="weight" name="weight" placeholder="重量"  class="form-control" ><span class="input-group-addon" >吨</span></div>
												<div class="input-group width-30" style="float: left"><input type="text" id="volumn" name="volumn" placeholder="体积"  class="form-control" ><span class="input-group-addon" >立方米</span></div>
											</div>
										</div>
										<div class="form-group">
											<label class="col-sm-2 control-label no-padding-right" for="form-field-1"> 出发地： </label>
											<div class="col-sm-4">
												<div>
													<input id="city_picker_dz_start" name="city_picker_dz_start" class="form-control" readonly type="text"
														value="重庆市/重庆市/沙坪坝区" data-toggle="city-picker" >
												</div>
											</div>
											<label class="col-sm-2 control-label no-padding-right" for="form-field-1">目的地：</label>
											<div class="col-sm-4">
												<div>
													<input id="city_picker_dz_end" name="city_picker_dz_end" class="form-control" readonly type="text" value="重庆市/重庆市/沙坪坝区"
														data-toggle="city-picker" >
												</div>
											</div>
										</div>
										<div class="form-group">
											<label class="col-sm-2 control-label no-padding-right" for="form-field-1">发货时间：  </label>
											<div class="col-sm-4">
												<div class="input-group">
													<input class="form-control date-picker" id="date_picker_dz_start" name="date_picker_dz_start" type="text"
														data-date-format="yyyy-mm-dd">
												</div>
											</div>
											<label class="col-sm-2 control-label no-padding-right" for="form-field-1">卸货时间 ：</label>
											<div class="col-sm-4">
												<div class="input-group">
													<input class="form-control date-picker" id="date_picker_dz_end" name="date_picker_dz_end" type="text"
														data-date-format="yyyy-mm-dd">
												</div>
											</div>
										</div>
										<div class="space-2"></div>
										<div>
											<div class="col-md-offset-1 col-md-9">
												<button class="btn btn-primary" type="submit">
													 确认发布并找车
												</button>

												&nbsp; &nbsp; &nbsp;
												<button class="btn btn-white btn-primary" type="reset">
													&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 重 &nbsp;&nbsp; 置&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
												</button>
											</div>
										</div>
									</form>
								</div>

								<div id="profile3" class="tab-pane">
									<form class="form-horizontal" action="ptjzh" method="post">
										<div class="form-group">
												<label class="col-sm-2 control-label no-padding-right" for="form-field-1"> 总量描述：</label>
												<div class="col-sm-10">
												<div class="input-group width-30" style="float: left">
													<select class="form-control" id="name" name="name"><option value="">---货物类型---</option>
													<option>酒类饮料</option>
													<option>塑料和橡胶</option>
													<option>皮革和纺织品</option>
													<option>纸和纸制品</option>
													<option>书和印刷品</option>
													<option>编结品</option>
													<option>文教用品</option>
													<option>日用百货</option>
													<option>非金属矿物产品</option>
													<option>其他</option>
												</select></div>
													<div class="input-group width-20" style="float: left"><input type="text" id="weight" name="weight" placeholder="重量"  class="form-control" ><span class="input-group-addon" >吨</span></div>
													<div class="input-group width-30" style="float: left"><input type="text" id="volumn" name="volumn" placeholder="体积"  class="form-control" ><span class="input-group-addon" >立方米</span></div>
													<div class="input-group width-20" style="float: left"><input type="text" id="totalPack" name="totalPack" placeholder="总件数"  class="form-control" ><span class="input-group-addon" >件</span></div>
												</div>
										</div>
										<div class="form-group">
												<label class="col-sm-2 control-label no-padding-right" for="form-field-1"> 单件描述：</label>
												<div class="col-sm-10">
													<div class="input-group width-25" style="float: left"><input type="text" id="unitLength" name="unitLength" placeholder="长"  class="form-control" ><span class="input-group-addon" >米</span></div>
													<div class="input-group width-25" style="float: left"><input type="text" id="unitWidth" name="unitWidth" placeholder="宽"  class="form-control" ><span class="input-group-addon" >米</span></div>
													<div class="input-group width-25" style="float: left"><input type="text" id="unitHeight" name="unitHeight" placeholder="高"  class="form-control" ><span class="input-group-addon" >米</span></div>
													<div class="input-group width-25" style="float: left"><input type="text" id="unitWeight" name="unitWeight" placeholder="重量"  class="form-control" ><span class="input-group-addon" >吨</span></div>
												</div>
										</div>
										<div class="form-group">
											<label class="col-sm-2 control-label no-padding-right" for="form-field-1">出发地：</label>
											<div class="col-sm-4">
												<div style="position: relative;">
													<input id="placeStart" name="placeStart" class="form-control" readonly type="text" value="重庆市/重庆市/沙坪坝区"
														data-toggle="city-picker" style="width: 180px;" >
												</div>
											</div>
											<label class="col-sm-2 control-label no-padding-right" for="form-field-1">目的地：</label>
											<div class="col-sm-4">
												<div  style="position: relative;">
													<input id="placeArrive" name="placeArrive" class="form-control" readonly type="text" value="重庆市/重庆市/沙坪坝区"
														data-toggle="city-picker"  style="width: 180px;" >
												</div>
											</div>
										</div>
										<div class="form-group">
											<label class="col-sm-2 control-label" for="form-field-1"> 发货时间：</label>
											<div class="col-sm-4">
												<div class="input-group">
													<input class="form-control date-picker" id="deliveryTime" name="deliveryTime" type="text" data-date-format="yyyy-mm-dd">
												</div>
											</div>
											<label class="col-sm-2 control-label" for="form-field-1">卸货时间：</label>
											<div class="col-sm-4">
												<div class="input-group">
													<input class="form-control date-picker" id="unloadTime" name="unloadTime" type="text" data-date-format="yyyy-mm-dd">
												</div>
											</div>
										</div>
										<div>
											<div class="col-md-offset-1 col-md-9">
												<button class="btn btn-primary" type="submit">
													 确认发布并找车
												</button>

												&nbsp; &nbsp; &nbsp;
												<button class="btn btn-white btn-primary" type="reset">
													&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 重 &nbsp;&nbsp; 置&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
												</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
						</div>
				<!-- end col-xs-9 -->
			</div>
			<!-- end col-xs-12 -->
		
		<div id="myCarousel" class="carousel slide div-pic">
				<!-- 轮播（Carousel）指标 -->
				<ol class="carousel-indicators">
					<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
					<li data-target="#myCarousel" data-slide-to="1"></li>
					<li data-target="#myCarousel" data-slide-to="2"></li>
				</ol>   
				<!-- 轮播（Carousel）项目 -->
				<div class="carousel-inner">
					<div class="item active">
						<img src="assets/img/banner/update.png" alt="First slide">
					</div>
					<div class="item">
						<img src="assets/img/banner/615meeting.jpg" alt="Second slide">
					</div>
					<div class="item">
						<img src="assets/img/banner/unCheat.jpg" alt="Third slide">
					</div>
				</div>
				<!-- 轮播（Carousel）导航 -->
					<a class="carousel-control left" href="#myCarousel" 
					   data-slide="prev">&lsaquo;</a>
					<a class="carousel-control right" href="#myCarousel" 
					   data-slide="next">&rsaquo;</a>
			</div> 
		
	<div class="content-msg">	
		<div class="header smaller lighter blue" align="center"><h2>实时车源</h2></div>
		<div class="cont" style="height: auto;">
			<div class="cont1-info">
				<div class="cont1-info-title">
					<div class="info-title1 col-xs-2 lighter">车主信息</div>
					<div class="info-title1 col-xs-3 lighter">车辆信息</div>
					<div class="info-title1 col-xs-2 lighter">目前所在地</div>
					<div class="info-title1 col-xs-2 lighter">期望目的地</div>
					<div class="info-title1 col-xs-1 lighter">手机号</div>
					<div class="info-title1 col-xs-2 lighter">操作</div>
				</div>
				<div class="cont1-info-lift" id="cont1-info-lift">
				</div>									
			</div>
		</div>
</div>
</div>

<input type="hidden" id="pagex" /> <input type="hidden" id="pagey"/>

<div class="showTable">
	<div class="blockdiv" id="blockdiv">
		<div class="box">
			<table style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap">
				<tr>
					<td colspan="2" align="center" style="font-size: medium;font: bold;">评价如下</td>
				</tr>
				<tr>
					<td>抵达时间：</td>
					<td id="ddsj"> <div id="ddsj"></div></td>
				</tr>
				<tr>
					<td>货损货差：</td>
					<td id="hshc"> <div id="hshc"></div></td>
				</tr>
				<tr>
					<td>服务态度：</td>
					<td id="fwtd"> <div id="fwtd"></div></td>
				</tr>
				<tr>
					<td>收费合理：</td>
					<td id="sfhl"> <div id="sfhl"></div></td>
				</tr>
				
			</table>
			<div style="text-align: left; color: green; line-height: 40px; height: 30px; display: none;" id="messagediv ">正在加载中...</div>
		</div>
	</div>
</div>

<script type="text/javascript">

window.onload = function() {
	
	$.get("getVehicleMsg",function(data,status){
		var data = data.data;
		var length =data.length;
		var list = document.getElementById("cont1-info-lift");
		list.innerHTML="";
		for(var i=0;i<length;i++){
			var divSpace = document.createElement("div");
			divSpace.style.cssText="height:2px";
			list.appendChild(divSpace);
			var ul = document.createElement("ul");
			ul.className="car-list";
			var li1=document.createElement("li");
			li1.className ="col-xs-2";
			var dl =document.createElement("dl");
			var dt = document.createElement("dt");
			dt.style.cssText="float: left";
			var img = document.createElement("img");
			img.src="assets/img/car/20589830_27.jpg";
			img.width="70";
			img.height="70";
			dt.appendChild(img);
			var dd =document.createElement("dd");
			dd.style.cssText="float:left";
			var ddul=document.createElement("dt");
			ddul.style.cssText="float:none";
			// 信息 
			var p = document.createElement("dd");
			p.innerHTML=data[i].carOwnerName;
			var p2=document.createElement("dd");
			p2.innerHTML="车主";
			
			var p3=document.createElement("dd");
			// 信息 
			p3.innerHTML=data[i].carNumber;
			
			var p4=document.createElement("dd");
			// 信息 
			p4.innerHTML=data[i].registerDate;
			
			ddul.appendChild(p);
			ddul.appendChild(p2);
			ddul.appendChild(p3);
			ddul.appendChild(p4);
			dd.appendChild(ddul);
			
			li1.appendChild(dt);
			li1.appendChild(dd);
			var id = data[i].id;
			li1.setAttribute("onmouseover","ShowInfo("+id+")");
			//li1.onmouseover=function(){
			//	ShowInfo();
			//};
			li1.setAttribute("onmouseout","HiddenInfo()")
			//li1.onmouseout=function(){
			//	HiddenInfo();
			//};
			
			var li2=document.createElement("li");
			li2.className ="col-xs-3";
			var p=document.createElement("p");
			p.innerHTML=data[i].carType;
			li2.appendChild(p);
			var p=document.createElement("p");
			p.innerHTML=data[i].maxWeight;
			li2.appendChild(p);
			var p=document.createElement("p");
			p.innerHTML=data[i].lwh;
			li2.appendChild(p);
			var li3=document.createElement("li");
			li3.className ="col-xs-2";
			var p=document.createElement("p");
			p.innerHTML=" ";
			li3.appendChild(p);
			var p=document.createElement("p");
			p.innerHTML=data[i].startPlace;
			li3.appendChild(p);
			var li4=document.createElement("li");
			li4.className ="col-xs-2";
			var p=document.createElement("p");
			p.innerHTML="   ";
			li4.appendChild(p);
			var p=document.createElement("p");
			p.innerHTML=data[i].destination;
			li4.appendChild(p);
			var li5=document.createElement("li");
			li5.className ="col-xs-1";
			var p=document.createElement("p");
			p.innerHTML="   ";
			li5.appendChild(p);
			var p=document.createElement("p");
			p.innerHTML=data[i].phone;
			li5.appendChild(p);
			var li6=document.createElement("li");
			li6.className ="col-xs-2";
			var p=document.createElement("p");
			p.innerHTML="  ";
			li6.appendChild(p);
			var b=document.createElement("button");
			b.className="btn btn-sm btn-primary";
			b.innerHTML="预约";
			b.style.cssText="width:80px;height:30px"
			var carNumber=data[i].carNumber; var name = data[i].carOwnerName;
			var phone=data[i].phone;var startPlace=data[i].startPlace;var destination= data[i].destination;
			var type=data[i].carType;var maxWeight=data[i].maxWeight;
			var lwh=data[i].lwh;
			b.setAttribute("onclick","showModalMsg("+id+",'"+carNumber+"','"+phone+"','"+startPlace+"','"+destination+"','"+maxWeight+"','"+type+"','"+lwh+"','"+name+"')");
	
			li6.appendChild(b);
			
			ul.appendChild(li1);
			ul.appendChild(li2);
			ul.appendChild(li3);
			ul.appendChild(li4);
			ul.appendChild(li5);
			ul.appendChild(li6);
			
			ul.onmouseover=function (){
				this.style.background='#F0FFF0';
			}
			ul.onmouseout=function(){
				this.style.background='';
			}
			
			list.appendChild(ul);
		}
	});
}

function showModalMsg(id,carNumber,phone,startPlace,destination,maxWeight,type,lwh,name){
	console.log("helo");
	$('#myModal #id').html(id);
	$('#myModal #name').html(name);
    $('#myModal #carNumber').html(carNumber);
    $('#myModal #carPhone').html(phone);
    $('#myModal #carNowPlace').html(startPlace);
    $('#myModal #carToPlace').html(destination);
    $('#myModal #carMsg').find("li").remove();
    var carMsg = document.getElementById("carMsg");
    var p=document.createElement("li");
    p.innerHTML=type;
    console.log(type);
    carMsg.appendChild(p);
    var p=document.createElement("li");
    p.innerHTML=maxWeight;
    carMsg.appendChild(p);
    var p=document.createElement("li");
    p.innerHTML=lwh;
    carMsg.appendChild(p);
    $('#myModal').modal('show');
}

jQuery(document).ready(function ($) {
	$(document).mousemove(function (e) {
	 document.getElementById("pagex").value = e.pageX;//pageX() 属性是鼠标指针的位置，相对于文档的左边缘。
	 document.getElementById("pagey").value = e.pageY;//pageY() 属性是鼠标指针的位置，相对于文档的上边缘。
	    });
});

function addStar(obj,val){
	$("#"+obj).html("");
	 for(var i = 0;i< val; i++){
		 $("#"+obj).append("<img src='assets/img/img/star-on.png'>&nbsp");
	 }
	for(var i = 0;i< (5-val); i++){
		$("#"+obj).append("<img src='assets/img/img/star-off.png'>&nbsp");
	 }
}

function ShowInfo(id) {
	var left=document.getElementById('pagex').value+"px";
	var top=document.getElementById('pagey').value-200+"px";
	console.log(id);
	
	$.post("getAssessMsg",{"id":id},function (data,status) {
	   if (data != null) {
		  addStar("ddsj",data.data.ddsj);
		  addStar("hshc",data.data.hshc);
		  addStar("fwtd",data.data.fwtd);
		  addStar("sfhl",data.data.sfhl);
		  $("#blockdiv").css({
			 "display": "block",
			 "left": left,
			 "top": top
			});
			
		  $("#messagediv").css("display", "none");
	    }else
	  		$("#messagediv").html("未加载到数据!");
	 });
}

function HiddenInfo() {
    $("#blockdiv").css({
 		"display": "none",
    });
    $("#lblusername").html("")
    $("#lblrealname").html("");
    $("#sex").html("");
    $("#lbladdress").html("")
    $("#lblemall").html("");
}
	

function taking(){
	// 获取编号  
	var id=$('#myModal #id').html();
	$.post("ordering",{"id":id,'flag':3},function(data,status){
		$('#myModal').hide();
		alert(data.msg);
		window.location.reload(); 
	});
}

jQuery(function($) {
	$('.date-picker').datepicker({
		autoclose: true,
		todayHighlight: true
	}).next().on(ace.click_event, function(){
		$(this).prev().focus();
	});
});

</script>
